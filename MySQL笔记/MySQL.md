# MySQL 笔记

## [MySQL查询过程](./MySQL_001.png)

## 数据库连接方式

1. 长连接：连接成功后，如果客户端持续有请求，则一直使用同一个连接
1. 短连接：每次执行完很少的几次查询就断开连接，下次查询再重新建立一个

* 注
  * 因为连接过程比较复杂，所以推荐长连接
  * 使用长连接时，MySQL在执行过程中临时的内存是管理在连接对象里面的。这些资源会在连接断开的时候才释放。所以如果长连接累积下来，可能导致内存占用太大，被系统强行杀掉（OOM），从现象看就是 MySQL 异常重启了。
  * 定期断开长连接 或者 MySQL5.7 之后可使用mysql_reset_connection来重新初始化连接资源(此过程不会重新连接和新做权限验证，会将连接恢复到刚刚创建完时的状态)

## MySQL更新语句执行过程

  主流程同查询过程

### 重要的日志模块 redo log模块

  更新时会用到[WAL(Write-Ahead Logging)技术](./MySQL_002.jpeg)，redo log模块
  
  [过程](./MySQL_003.jpeg)

### 重要的日志模块 binlog模块

  [为何会有两个日志模块？](./MySQL_004.jpeg)

  [更新语句执行过程](./MySQL_005.jpeg)
  